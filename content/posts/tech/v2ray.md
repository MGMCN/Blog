---
title: "å¦‚ä½•æ´»ç”¨V2rayæŠµå¾¡åˆæ³•çš„ä¸­é—´äººæ”»å‡»ğŸ¤ª"
date: 2025-10-31T10:25:48+09:00
draft: false
categories: []
tags: []
summary: æœ¬æ–‡æ•™ä½ æ€ä¹ˆè½»æ¾ç»•è¿‡å…¬å¸ç½‘ç»œå®‰å…¨ç­–ç•¥ä¸­çš„ä¸­é—´äººæ”»å‡»
author: "MGMCN"
showToc: false
TocOpen: false
hidemeta: false
comments: true
disableShare: false
disableHLJS: false
hideSummary: false
searchHidden: false
ShowReadingTime: true
ShowBreadCrumbs: true
ShowPostNavLinks: true
ShowWordCount: false
ShowRssButtonInSectionTermList: true
UseHugoToc: true
# cover:
#     image: "<image path/url>" # image path/url
#     alt: "<alt text>" # alt text
#     caption: "<text>" # display caption under cover
#     relative: false # when using page bundles set this to true
#     hidden: true # only hide on current single page
---

# èƒŒæ™¯
å…¬å¸ä¸ºäº†é˜²æ­¢æœºå¯†æ³„æ¼ï¼Œä¸€èˆ¬ä¼šä½¿ç”¨è¯ä¹¦æ›¿æ¢ä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„ä¸­é—´äººæ”»å‡»å¯¹æˆ‘ä»¬å‘å¤–å‘å‡ºçš„è¯·æ±‚è¿›è¡Œå®¡æŸ¥ã€‚å…¬å¸ä¼šé¢„å…ˆåœ¨æˆ‘ä»¬çš„ç”µè„‘ä¸Šå®‰è£…ä¼ä¸šæ ¹è¯ä¹¦ï¼ˆå…¬é’¥éƒ¨åˆ†ï¼‰ï¼Œæˆ‘ä»¬å‘å‡ºçš„å‘å¤–çš„è¯·æ±‚è¢«å…¬å¸åŠ«æŒåå…¬å¸ä¼šç»™æˆ‘ä»¬çš„è¯·æ±‚ä¸‹å‘ä¸€ä¸ªç­¾åè¯ä¹¦ï¼Œæˆ‘ä»¬ä½¿ç”¨æœ¬åœ°å—ä¿¡ä»»çš„å…¬å¸é¢„è£…çš„æ ¹CAå…¬é’¥å»éªŒè¯ï¼Œå‘ç°æ˜¯åˆæ³•çš„ä¸”æ˜¯è¢«ä¿¡ä»»çš„CAç­¾å‘çš„ï¼ŒåŒæ—¶è¯ä¹¦å¹¶æ²¡æœ‰è¿‡æœŸï¼ŒåŸŸåä¹ŸåŒ¹é…ã€‚ç„¶åæˆ‘ä»¬å’Œå…¬å¸çš„æœåŠ¡å™¨ä¹‹é—´å°±èƒ½é€šè¿‡åç»­çº¦å®šçš„ä¸´æ—¶å¯†é’¥è¿›è¡ŒåŠ å¯†è§£å¯†é€šä¿¡ã€‚å…¬å¸èƒ½å¤Ÿæ‹¿åˆ°æˆ‘ä»¬å¯¹å¤–è¯·æ±‚çš„æ‰€æœ‰æ˜æ–‡ä¿¡æ¯ï¼Œç„¶åé’ˆå¯¹é‡Œé¢çš„è¯¸å¦‚åŸŸåç­‰ç­‰ä¿¡æ¯ä½œé™åˆ¶ï¼Œç„¶åé€‰æ‹©æ€§çš„æ”¾è¡Œè¯·æ±‚ï¼Œå®ç°ç»†ç²’åº¦çš„æ§åˆ¶ã€‚å¸¸è§çš„è¿™ç±»ä¸­é—´äººæ”»å‡»å·¥å…·æœ‰Netskope
# æ–¹æ³•åŸç†
é¦–å…ˆæˆ‘ä»¬å¿…é¡»å¾—æœ‰ä¸€ä¸ªè¢«å…¬å¸ä¿¡ä»»çš„äººå­˜åœ¨ï¼Œä¾‹å¦‚cloudflareè¿™ç±»CDNå…¬å¸ï¼Œæˆ‘ä»¬éƒ¨ç½²V2ray Serveråœ¨æˆ‘ä»¬è‡ªå·±æœåŠ¡å™¨ä¸Šï¼Œä½¿ç”¨cloudflare tunnelæŠ€æœ¯å®šå‘åˆ°ä¸è¿™ä¸ªServeré€šä¿¡ã€‚ï¼ˆé’ˆå¯¹æ²¡æœ‰å…¬å…±ipå´æœ‰è‡ªå·±domainä¹Ÿæœ‰è‡ªå·±å®¶ç”¨æœåŠ¡å™¨-æ ‘è“æ´¾ç­‰çš„æƒ…å†µï¼‰ç„¶åæˆ‘ä»¬åœ¨å…¬å¸ç”µè„‘ä¸Šå®‰è£…V2ray Clientï¼Œå®šä¹‰å¥½æˆ‘ä»¬æƒ³è¦ç»•è¿‡å…¬å¸ä¸­é—´äººæ”»å‡»å®‰å…¨ç­–ç•¥çš„routingè§„åˆ™ã€‚ç„¶ååœ¨æµè§ˆå™¨æˆ–è€…ç³»ç»Ÿç½‘ç»œé…ç½®é‡Œé…ç½®å¥½ç›¸åº”çš„V2ray Client Proxyï¼Œé…ç½®å¥½åï¼Œæ‰€æœ‰çš„è¯·æ±‚å°†é€šè¿‡è¿™ä¸ªClientå‘é€ã€‚æ‰€ä»¥ç°åœ¨çš„è¯·æ±‚å°±å˜æˆäº†ï¼Œç”¨æˆ·è¯·æ±‚ -> V2ray Client Proxy -> VLESS åŒ…è£…åè¯·æ±‚ -> å…¬å¸æ‹¦æˆªè§£å¯† -> bodyå†…å®¹æ— æ³•è§£æå·²ç»è¢«åŠ å¯† -> æ”¾è¡Œ -> cloudflare tunnel -> home proxy è§£å¯† -> ä»£æ›¿æˆ‘ä»¬è¯·æ±‚ç„¶åè¿”å›ç»™ç”¨æˆ· 
# Serveré…ç½®
ç”ŸæˆUUID
```bash
$ sudo apt install -y uuid-runtime
$ UUID=$(uuidgen)
$ echo $UUID
# è®°å½•è¿™ä¸ª UUIDï¼Œåé¢ server/client éƒ½è¦ç”¨åŒä¸€ä¸ª
```
åœ¨æ ‘è“æ´¾ä¸Šå®‰è£…v2ray
```bash
$ bash <(curl -sL https://raw.githubusercontent.com/v2fly/fhs-install-v2ray/master/install-release.sh)
$ sudo systemctl enable v2ray
$ sudo systemctl start v2ray
$ sudo systemctl status v2ray
$ vim /usr/local/etc/v2ray/config.json # å†…å®¹è§ä¸‹ï¼Œæ³¨æ„æ›¿æ¢ä¸ºä½ è‡ªå·±çš„é…ç½®
$ sudo systemctl restart v2ray
```
å¦‚ä½•åœ¨cloudflaredä¸Šå»ºç«‹éš§é“è¯·å‚ç…§[å®˜æ–¹æ–‡æ¡£](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/get-started/)ã€‚
ä½ éœ€è¦é…ç½®abc.your_domain.xyz -> http://127.0.0.1:10086 ç„¶ååœ¨ä½ çš„server(æ ‘è“æ´¾)ä¸Šè¿è¡Œcloudflareæ¥ç»´æŒä½ çš„tunnelè¿è¡Œã€‚
```json
{
  "log": {
    "loglevel": "info"
  },
  "inbounds": [
    {
      "port": 10086,
      "listen": "127.0.0.1",
      "protocol": "vless",
      "settings": {
        "clients": [
          {
            "id": "<UUID>",
            "level": 0
          }
        ],
        "decryption": "none"
      },
      "streamSettings": {
        "network": "ws",
        "wsSettings": {
          "path": "/v2ray"
        }
      }
    }
  ],
  "outbounds": [
    {
      "protocol": "freedom",
      "settings": {}
    }
  ]
}
```
ä½ ä¹Ÿå¯ä»¥é€‰æ‹©ä½¿ç”¨vmessï¼Œä½†æ³¨æ„serverå’Œclientåè®®è¦åŒ¹é…ã€‚è¿™é‡Œä½¿ç”¨vlessæ˜¯å› ä¸ºæ¯”è¾ƒå¿«ã€‚
# Clienté…ç½®
```bash
# ä»¥ä¸‹æŒ‡ä»¤åœ¨Macä¸ŠéªŒè¯è¿‡ï¼Œä½ éœ€è¦æ ¹æ®ä½ çš„æ“ä½œç³»ç»Ÿè°ƒæ•´
$ brew install v2ray
$ vim ~/abc/xyz/config.json # å†…å®¹è§ä¸‹ï¼Œæ³¨æ„æ›¿æ¢ä¸ºä½ è‡ªå·±çš„é…ç½®
$ v2ray run -c  ~/abc/xyz/config.json
```
```json
{
  "log": {
    "loglevel": "info"
  },
  "inbounds": [
    {
      "port": 1080,
      "listen": "127.0.0.1",
      "protocol": "socks",
      "settings": {
        "auth": "noauth",
        "udp": true,
        "ip": "127.0.0.1"
      },
      "sniffing": {
        "enabled": true,
        "destOverride": ["http", "tls"]
      }
    }
  ],
  "outbounds": [
    {
      "tag": "home-proxy",
      "protocol": "vless",
      "settings": {
        "vnext": [
          {
            "address": "abc.your_domain.xyz",
            "port": 443,
            "users": [
              {
                "id": "<UUID>",
                "encryption": "none"
              }
            ]
          }
        ]
      },
      "streamSettings": {
        "network": "ws",
        "security": "tls",
        "wsSettings": {
          "path": "/v2ray"
        },
        "tlsSettings": {
          "serverName": "abc.your_domain.xyz",
          "allowInsecure": false
        }
      }
    },
    {
      "tag": "direct",
      "protocol": "freedom",
      "settings": {}
    }
  ],
  "routing": {
    "domainStrategy": "IPIfNonMatch",
    "rules": [
      {
        "type": "field",
        "domain": [
          "geosite:openai",
          "domain:openai.com",
          "domain:chatgpt.com",
          "domain:oaistatic.com",
          "domain:oaiusercontent.com",
          "domain:auth0.openai.com",
          "domain:challenges.cloudflare.com",
	      "domain:mail.google.com",
	      "domain:linkedin.com"
        ],
        "outboundTag": "home-proxy"
      },
      {
        "type": "field",
        "ip": [
          "geoip:private"
        ],
        "outboundTag": "direct"
      },
      {
        "type": "field",
        "port": "0-65535",
        "outboundTag": "direct"
      }
    ]
  },
  "dns": {
    "servers": [
      "https+local://1.1.1.1/dns-query",
      "8.8.8.8"
    ]
  }
}

```
ç„¶åä½ éœ€è¦åœ¨ä½ çš„æµè§ˆå™¨(ä¾‹å¦‚FoxyProxyä¹‹ç±»çš„æ’ä»¶)æˆ–è€…ç½‘ç»œé…ç½®é‡Œæ·»åŠ è¿™ä¸ªclientçš„proxyé…ç½®ï¼Œè½¬å‘è¯·æ±‚åˆ°127.0.0.1:1080ï¼ŒTypeé€‰SOCKS5å°±è¡Œäº†ï¼Œç„¶åä½ å†æ‰“å¼€æµè§ˆå™¨è®¿é—®è¢«å…¬å¸blockçš„ç½‘é¡µï¼Œä½ åº”è¯¥èƒ½æˆåŠŸè®¿é—®äº†ï¼

# Warning
è¯·ä¸è¦å‚ç…§æœ¬æ–‡æ¡£åšä»»ä½•è¿æ³•è¿è§„çš„äº‹ï¼Œå¦‚å› æ­å»ºV2rayå¯¼è‡´ä»»ä½•è¿æ³•è¿è§„å½±å“ï¼Œä¸€åˆ‡åæœè‡ªè´Ÿï¼


